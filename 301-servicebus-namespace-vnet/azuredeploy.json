{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"serviceBusNamespaceName": {
			"type": "string",
			"metadata": {
				"description": "Name of the Service Bus namespace"
			}
		},
		"vnetRuleName": {
			"type": "string",
			"metadata": {
				"description": "Name of the Virtual Network Rule"
			}
		},
		"virtualNetworkSubnetId": {
			"type": "string",
			"defaultValue": "default",
			"metadata": {
				"description": "Azure Resource Manager Id of SubNet"
			}
		},
		"Location": {
			"type": "string",
			"defaultValue": "East US2"
		}
	},
	"variables": {
		"namespaceVirtualNetworkRuleName": "[concat(parameters('serviceBusNamespaceName'), concat('/', parameters('vnetRuleName')))]"
		},
		"resources": [{
				"apiVersion": "2018-01-01-preview",
				"name": "[parameters('serviceBusNamespaceName')]",
				"type": "Microsoft.ServiceBus/namespaces",
				"location": "[parameters('Location')]",
				"sku": {
					"name": "Premium",
					"tier": "Premium"
				},
				"properties": {}
			}, {
				"apiVersion": "2018-01-01-preview",
				"name": "[variables('namespaceVirtualNetworkRuleName')]",
				"type": "Microsoft.ServiceBus/namespaces/VirtualNetworkRules",
				"dependsOn": [
					"[concat('Microsoft.ServiceBus/namespaces/', parameters('serviceBusNamespaceName'))]"
				],
				"properties": {
					"virtualNetworkSubnetId": "[resourceId('Microsoft.Network/virtualNetworks/subnets/', parameters('vnetRuleName'),'default')]"
				}
			}
		],
		"outputs": {}
	}