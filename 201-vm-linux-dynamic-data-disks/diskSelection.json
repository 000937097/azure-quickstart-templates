{
  "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "numDataDisks": {
      "type": "string",
      "allowedValues": [
        "0",
        "1",
        "2",
        "3",
        "4",
        "5",
        "6",
        "7",
        "8",
        "9",
        "10",
        "11",
        "12",
        "13",
        "14",
        "15",
        "16"
      ],
      "metadata": {
        "description": "This parameter allows the user to select the number of disks they want"
      }
    },
    "diskStorageAccountUri": {
      "type": "string",
      "metadata": {
        "description": "Uri of the storage account where the data disks are stored"
      }
    },
    "diskCaching": {
      "type": "string",
      "allowedValues": [
        "None",
        "ReadOnly",
        "ReadWrite"
      ],
      "metadata": {
        "description": "Caching type for the data disks"
      }
    },
    "vmStAccountContainerName": {
      "type": "string",
      "metadata": {
        "description": "Name of the storage account Container Name"
      }
    },
    "masterName": {
      "type": "string",
      "metadata": {
        "description": "Master Host Name"
      }
    },
    "diskSizeGB": {
      "type": "int",
      "minValue": 1,
      "maxValue": 4095,
      "metadata": {
        "description": "Size of the data disks"
      }
    }
  },
  "variables": {
    "uriPrefix": "[uri(parameters('diskStorageAccountUri'), concat(parameters('vmStAccountContainerName'), '/', parameters('masterName')))]",
    "dataDisks": [
      {
        "name": "datadisk0",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 0,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk0.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "name": "datadisk1",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 1,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk1.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "name": "datadisk2",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 2,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk2.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "name": "datadisk3",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 3,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk3.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "name": "datadisk4",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 4,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk4.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "name": "datadisk5",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 5,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk5.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "name": "datadisk6",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 6,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk6.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "name": "datadisk7",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 7,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk7.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "name": "datadisk8",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 8,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk8.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "name": "datadisk9",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 9,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk9.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "name": "datadisk10",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 10,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk10.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "name": "datadisk11",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 11,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk11.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "name": "datadisk12",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 12,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk12.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "name": "datadisk13",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 13,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk13.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "name": "datadisk14",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 14,
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk14.vhd')]"
        },
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty"
      },
      {
        "caching": "[parameters('diskCaching')]",
        "createOption": "Empty",
        "diskSizeGB": "[parameters('diskSizeGB')]",
        "lun": 15,
        "name": "datadisk15",
        "vhd": {
          "uri": "[concat(variables('uriPrefix'),'-datadisk15.vhd')]"
        }
      }
    ]
  },
  "resources": [],
  "outputs": {
    "dataDiskArray": {
      "type": "array",
      "value": "[take(variables('dataDisks'), int(parameters('numDataDisks')))]"
    }
  }
}
